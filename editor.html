<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>HAHUIDE - Editor</title>

<!-- CodeMirror (for highlighting) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/dracula.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/javascript/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/xml/xml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/css/css.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/htmlmixed/htmlmixed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/clike/clike.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/python/python.min.js"></script>

<style>
body {
  margin: 0;
  background: #1e1e1e;
  color: white;
  font-family: "Segoe UI", sans-serif;
  display: flex;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

header {
  background: #2b2b2b;
  padding: 10px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}

header h1 {
  font-size: 18px;
  color: #00aaff;
  margin: 0;
}

.actions {
  display: flex;
  align-items: center;
  gap: 10px;
}

.actions button, .actions select {
  background: #0078ff;
  border: none;
  color: white;
  padding: 8px 12px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 14px;
}

.actions select {
  background: #333;
  color: #fff;
}

main {
  display: flex;
  flex: 1;
  overflow: hidden;
}

/* Left editor area */
.editor-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: #1e1e1e;
}

.CodeMirror {
  height: 100%;
  width: 100%;
  font-size: 14px;
  line-height: 1.5;
  border-right: 2px solid #333;
}

/* Fixed right output panel */
.output-container {
  width: 50%;
  height: 100%;
  background: #fff;
  border-left: 2px solid #333;
  position: relative;
}

iframe#output {
  width: 100%;
  height: 100%;
  border: none;
  background: white;
}
</style>
</head>
<body>

<header>
  <h1>üíª HAHUIDE</h1>
  <div class="actions">
    <select id="language">
      <option value="html">HTML / CSS / JS</option>
      <option value="python">Python</option>
      <option value="text/x-c++src">C++</option>
      <option value="text/x-csharp">C#</option>
      <option value="javascript">JavaScript</option>
    </select>
    <button onclick="runCode()">‚ñ∂ Run</button>
    <button onclick="saveCode()">üíæ Save</button>
    <button onclick="loadCode()">üìÇ Load</button>
    <button onclick="logout()">üö™ Logout</button>
  </div>
</header>

<main>
  <div class="editor-container">
    <textarea id="editor"></textarea>
  </div>
  <div class="output-container">
    <iframe id="output"></iframe>
  </div>
</main>

<script>
let editor = CodeMirror.fromTextArea(document.getElementById("editor"), {
  mode: "htmlmixed",
  theme: "dracula",
  lineNumbers: true,
  tabSize: 2
});

const languageSelect = document.getElementById("language");

languageSelect.addEventListener("change", () => {
  const lang = languageSelect.value;
  editor.setOption("mode", lang === "html" ? "htmlmixed" : lang);
});

function runCode() {
  const lang = languageSelect.value;
  const outputFrame = document.getElementById("output");
  const outputDoc = outputFrame.contentDocument || outputFrame.contentWindow.document;

  if (lang === "html") {
    outputDoc.open();
    outputDoc.write(editor.getValue());
    outputDoc.close();
  } else {
    outputDoc.open();
    outputDoc.write("<pre style='font-size:14px;padding:10px;'>" +
      "‚ö†Ô∏è Only HTML, CSS, and JS can run directly in the browser.\n" +
      "For Python, C++, and others, you'll need a backend compiler or API." +
      "</pre>");
    outputDoc.close();
  }
}

function saveCode() {
  localStorage.setItem("hahuidesave", editor.getValue());
  alert("‚úÖ Code saved!");
}

function loadCode() {
  const saved = localStorage.getItem("hahuidesave");
  if (saved) {
    editor.setValue(saved);
  } else {
    alert("‚ö†Ô∏è No saved code found!");
  }
}

function logout() {
  alert("üëã Logging out...");
  window.location.href = "login.html";
}
</script>

</body>
</html>
